I've made some changes, I should fork this
